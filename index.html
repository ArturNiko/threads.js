<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Vite App</title>
</head>
<body>
<div id="app"></div>
<script type="module">
    import Threads from './dist/index.mjs'

    const threads = new Threads(4)

    function test1(message) {
        let counter = message.data ?? 0
        for (let i = 0; i < 1000000; i++) {
            counter += i
        }

        postMessage(counter)
    }

    /**
     * [ // Chained execution for each thread
     *     [task -> task -> task]
     *     [task -> task]
     *     [task -> task]
     *     [task -> task]
     * ]
     *
     */
    threads
        .push(test1)
        .push(test1)
        .push(test1)
        .push(test1)
        .push(test1)
        .push(test1)
        .push(test1)
        .push(test1)
        .push(test1)


    console.log('Threads are loaded:')
    console.log(threads.threads)

    console.time('Execution took')

    console.log(await threads.execute({messageMode: 'chained', responseMode: 'last'}))

</script>
</body>
</html>
